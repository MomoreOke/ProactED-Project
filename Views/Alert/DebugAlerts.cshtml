@{
    ViewData["Title"] = "Debug Alerts";
    var alertList = ViewBag.AlertInfo as List<dynamic> ?? new List<dynamic>();
}

<h1>Debug: All Alerts in Database</h1>

<div class="alert alert-info">
    <h5>Total Alerts: @alertList.Count</h5>
</div>

@if (alertList.Any())
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Description</th>
                <th>Created Date</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var alert in alertList)
            {
                <tr>
                    <td>@alert.Id</td>
                    <td>@alert.Title</td>
                    <td>@alert.Description</td>
                    <td>@alert.CreatedDate</td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="alert alert-warning">
        <strong>No alerts found in database.</strong>
    </div>
}

<div class="mt-3">
    <a asp-action="Index" class="btn btn-secondary me-2">Back to Alerts</a>
    <a asp-action="TestClearCriteria" class="btn btn-info me-2">
        <i class="bi bi-search"></i> Test Clear Criteria
    </a>
    <br class="d-block d-md-none mb-2">
    <form asp-action="ClearAllAutoGeneratedAlerts" method="post" class="d-inline me-2">
        <button type="submit" class="btn btn-warning" onclick="return confirm('Are you sure you want to clear ALL auto-generated alerts? This uses enhanced detection criteria.')">
            <i class="bi bi-trash"></i> Clear Auto-Generated (Enhanced)
        </button>
    </form>
    <form asp-action="SqlCleanupAutoGenerated" method="post" class="d-inline me-2">
        <button type="submit" class="btn btn-primary" onclick="return confirm('Use SQL cleanup for stubborn auto-generated data? This is more thorough.')">
            <i class="bi bi-database"></i> SQL Cleanup
        </button>
    </form>
    <form asp-action="ClearAllAlerts" method="post" class="d-inline">
        <button type="submit" class="btn btn-danger" onclick="return confirm('DANGER: This will delete ALL alerts and maintenance tasks! Are you absolutely sure?')">
            <i class="bi bi-exclamation-triangle"></i> Clear ALL (Nuclear Option)
        </button>
    </form>
</div>
